<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MultiTool Web App - Image Tools</title>
    
    <!-- Meta tags for social sharing -->
    <meta property="og:title" content="MultiTool Web App - Free Image Tools">
    <meta property="og:description" content="Your go-to online tools for image background removal, compression, resizing, and merging.">
    <meta property="og:image" content="https://via.placeholder.com/1200x630.png?text=MultiToolApp_Preview"> <!-- Replace with your actual preview image URL -->
    <meta property="og:url" content="https://yourdomain.com"> <!-- Replace with your actual site URL -->
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="MultiTool Web App - Free Image Tools">
    <meta name="twitter:description" content="Your go-to online tools for image background removal, compression, resizing, and merging.">
    <meta name="twitter:image" content="https://via.placeholder.com/1200x630.png?text=MultiToolApp_Preview"> <!-- Replace with your actual preview image URL -->

    <!-- Font Awesome for icons (social media, download icon) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --light-bg: #f8f9fa;
            --dark-bg: #343a40;
            --text-color: #333;
            --light-text-color: #fff;
            --border-color: #dee2e6;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        body {
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--light-bg);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            background-color: var(--dark-bg);
            color: var(--light-text-color);
            padding: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
        }

        header .logo {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--light-text-color);
            text-decoration: none;
            margin-right: 20px;
        }

        header nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap; /* Allow wrapping */
        }

        header nav ul li {
            margin-left: 20px;
        }

        header nav ul li a {
            color: var(--light-text-color);
            text-decoration: none;
            padding: 5px 10px;
            transition: color 0.3s ease;
        }

        header nav ul li a:hover {
            color: var(--primary-color);
        }

        .download-app {
            background-color: var(--primary-color);
            padding: 8px 15px;
            border-radius: 5px;
            text-decoration: none;
            color: var(--light-text-color);
            display: flex;
            align-items: center;
            transition: background-color 0.3s ease;
        }
        .download-app:hover {
            background-color: #0056b3;
        }
        .download-app i {
            margin-right: 5px;
        }

        /* Welcome Banner */
        .welcome-banner {
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://via.placeholder.com/1500x500/007bff/ffffff?text=Image+Tools+Banner') no-repeat center center/cover;
            color: var(--light-text-color);
            text-align: center;
            padding: 80px 20px;
            margin-bottom: 30px;
        }
        .welcome-banner h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
        }
        .welcome-banner p {
            font-size: 1.2em;
            max-width: 800px;
            margin: 0 auto;
        }

        /* Tool Buttons */
        .tool-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .tool-button {
            background-color: var(--light-text-color);
            border: 1px solid var(--border-color);
            padding: 30px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .tool-button:hover {
            background-color: var(--primary-color);
            color: var(--light-text-color);
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .tool-button i {
            font-size: 3em;
            margin-bottom: 15px;
            color: var(--primary-color); /* Default icon color */
            transition: color 0.3s ease;
        }
        .tool-button:hover i {
            color: var(--light-text-color); /* Icon color on hover */
        }
        .tool-button h3 {
            font-size: 1.4em;
        }

        /* Tool Sections */
        .tool-section {
            background-color: var(--light-text-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: none; /* Hidden by default */
        }
        .tool-section.active {
            display: block; /* Shown when active */
        }
        .tool-section h2 {
            font-size: 2em;
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        .tool-section .input-group {
            margin-bottom: 20px;
        }
        .tool-section label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .tool-section input[type="file"] {
            display: block;
            margin-bottom: 15px;
        }
        .tool-section input[type="range"],
        .tool-section input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .tool-section button {
            background-color: var(--primary-color);
            color: var(--light-text-color);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
            margin-right: 10px;
        }
        .tool-section button:hover {
            background-color: #0056b3;
        }
        .tool-section .preview-area {
            margin-top: 30px;
            border: 1px dashed var(--border-color);
            padding: 20px;
            min-height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--light-bg);
            flex-direction: column;
        }
        .tool-section .preview-area img {
            max-width: 100%;
            max-height: 400px;
            height: auto;
            display: block;
            margin-bottom: 15px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .tool-section .preview-area canvas {
            max-width: 100%;
            max-height: 400px;
            height: auto;
            display: block;
            margin-bottom: 15px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border: 1px solid #ddd;
        }
        .tool-section .message {
            margin-top: 15px;
            font-style: italic;
            color: var(--secondary-color);
        }

        /* Feature Contents */
        .features-section {
            padding: 40px 0;
            background-color: var(--light-bg);
            text-align: center;
        }
        .features-section h2 {
            font-size: 2.5em;
            margin-bottom: 30px;
            color: var(--primary-color);
        }
        .feature-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }
        .feature-card {
            background-color: var(--light-text-color);
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            text-align: left;
        }
        .feature-card h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        .feature-card p {
            font-size: 0.95em;
            color: #555;
        }

        /* Footer */
        footer {
            background-color: var(--dark-bg);
            color: var(--light-text-color);
            padding: 30px 0;
            text-align: center;
            margin-top: auto; /* Pushes footer to the bottom */
        }
        footer .footer-links ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        footer .footer-links ul li {
            margin: 0 15px;
        }
        footer .footer-links ul li a {
            color: var(--light-text-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        footer .footer-links ul li a:hover {
            color: var(--primary-color);
        }
        .social-icons a {
            color: var(--light-text-color);
            font-size: 1.5em;
            margin: 0 10px;
            transition: color 0.3s ease;
        }
        .social-icons a:hover {
            color: var(--primary-color);
        }
        footer p {
            margin-top: 20px;
            font-size: 0.9em;
            color: #ccc;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            header .container {
                flex-direction: column;
                text-align: center;
            }
            header .logo {
                margin-bottom: 15px;
            }
            header nav ul {
                margin-bottom: 15px;
                justify-content: center;
            }
            header nav ul li {
                margin: 0 10px;
            }
            .welcome-banner h1 {
                font-size: 2em;
            }
            .welcome-banner p {
                font-size: 1em;
            }
            .tool-buttons {
                grid-template-columns: 1fr; /* Stack buttons vertically */
            }
            .tool-button {
                padding: 20px;
            }
            .features-section h2 {
                font-size: 2em;
            }
            .feature-cards {
                grid-template-columns: 1fr;
            }
            footer .footer-links ul {
                flex-direction: column;
            }
            footer .footer-links ul li {
                margin: 5px 0;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <a href="#" class="logo">MultiTool App</a>
            <nav>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="mailto:contact@yourdomain.com" target="_blank" rel="noopener noreferrer">Contact</a></li>
                    <li><a href="mailto:support@yourdomain.com" target="_blank" rel="noopener noreferrer">Support</a></li>
                    <li><a href="https://play.google.com/store/apps/details?id=your.app.package" class="download-app" target="_blank" rel="noopener noreferrer">
                        <i class="fab fa-android"></i> Download App
                    </a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="welcome-banner" id="home">
            <h1>Your All-in-One Image Toolkit</h1>
            <p>Unlock the power of images with our free online tools for background removal, compression, resizing, and merging. Fast, simple, and high quality.</p>
        </section>

        <section class="container">
            <div class="tool-buttons">
                <div class="tool-button" data-tool="background-remover">
                    <i class="fas fa-cut"></i>
                    <h3>Image Background Remover</h3>
                </div>
                <div class="tool-button" data-tool="compressor">
                    <i class="fas fa-compress-alt"></i>
                    <h3>Image Compressor</h3>
                </div>
                <div class="tool-button" data-tool="resizer">
                    <i class="fas fa-expand-alt"></i>
                    <h3>Image Resizer</h3>
                </div>
                <div class="tool-button" data-tool="merger">
                    <i class="fas fa-layer-group"></i>
                    <h3>Merge Images</h3>
                </div>
            </div>

            <!-- Tool Sections -->
            <div id="background-remover-tool" class="tool-section">
                <h2>Image Background Remover</h2>
                <p class="message">
                    <strong>Note:</strong> High-quality, general-purpose background removal purely client-side and for free is very complex and may not match professional software or AI services. This tool would typically require advanced machine learning models (e.g., via TensorFlow.js) or integration with server-side APIs for best results.
                </p>
                <div class="input-group">
                    <label for="bgRemoverInput">Upload Image:</label>
                    <input type="file" id="bgRemoverInput" accept="image/*">
                </div>
                <button id="processBgRemover">Process Background Removal (Conceptual)</button>
                <div class="preview-area">
                    <img id="bgRemoverPreview" src="" alt="Background Remover Preview" style="display: none;">
                    <p>Your processed image will appear here.</p>
                </div>
                <button id="downloadBgRemover" style="display: none;">Download Image</button>
            </div>

            <div id="compressor-tool" class="tool-section">
                <h2>Image Compressor</h2>
                <div class="input-group">
                    <label for="compressorInput">Upload Image:</label>
                    <input type="file" id="compressorInput" accept="image/*">
                </div>
                <div class="input-group">
                    <label for="compressionQuality">Compression Quality: <span id="qualityValue">80</span>%</label>
                    <input type="range" id="compressionQuality" min="10" max="100" value="80">
                </div>
                <button id="compressImage">Compress Image</button>
                <div class="preview-area">
                    <img id="compressorPreview" src="" alt="Compressor Preview" style="display: none;">
                    <p id="compressorOriginalSize" style="display: none;"></p>
                    <p id="compressorNewSize" style="display: none;"></p>
                    <p>Your compressed image will appear here.</p>
                </div>
                <button id="downloadCompressor" style="display: none;">Download Image</button>
            </div>

            <div id="resizer-tool" class="tool-section">
                <h2>Image Resizer</h2>
                <div class="input-group">
                    <label for="resizerInput">Upload Image:</label>
                    <input type="file" id="resizerInput" accept="image/*">
                </div>
                <div class="input-group">
                    <label>Current Dimensions: <span id="originalDimensions">N/A</span></label>
                </div>
                <div class="input-group">
                    <label for="newWidth">New Width (px):</label>
                    <input type="number" id="newWidth" placeholder="e.g., 800">
                </div>
                <div class="input-group">
                    <label for="newHeight">New Height (px):</label>
                    <input type="number" id="newHeight" placeholder="e.g., 600">
                </div>
                 <div class="input-group">
                    <input type="checkbox" id="maintainAspectRatio" checked>
                    <label for="maintainAspectRatio">Maintain Aspect Ratio</label>
                </div>
                <button id="resizeImage">Resize Image</button>
                <div class="preview-area">
                    <img id="resizerPreview" src="" alt="Resizer Preview" style="display: none;">
                    <p>Your resized image will appear here.</p>
                </div>
                <button id="downloadResizer" style="display: none;">Download Image</button>
            </div>

            <div id="merger-tool" class="tool-section">
                <h2>Merge Images</h2>
                <p class="message">
                    Upload multiple images to merge them. You'll need to define how they should be arranged (e.g., side-by-side, top-bottom) and any borders/backgrounds.
                </p>
                <div class="input-group">
                    <label for="mergerInput1">Upload Image 1:</label>
                    <input type="file" id="mergerInput1" accept="image/*">
                </div>
                <div class="input-group">
                    <label for="mergerInput2">Upload Image 2:</label>
                    <input type="file" id="mergerInput2" accept="image/*">
                </div>
                <!-- More inputs or dynamic adding of inputs would be needed for multiple images -->
                <div class="input-group">
                    <label for="mergeBorderColor">Border Color:</label>
                    <input type="color" id="mergeBorderColor" value="#000000">
                </div>
                <div class="input-group">
                    <label for="mergeBorderWidth">Border Width (px):</label>
                    <input type="number" id="mergeBorderWidth" value="5" min="0">
                </div>
                <div class="input-group">
                    <label for="mergeBgColor">Background Color:</label>
                    <input type="color" id="mergeBgColor" value="#ffffff">
                </div>
                <button id="mergeImages">Merge Images (Conceptual)</button>
                <div class="preview-area">
                    <canvas id="mergerCanvas" style="display: none;"></canvas>
                    <p>Your merged image will appear here.</p>
                </div>
                <button id="downloadMerger" style="display: none;">Download Image</button>
            </div>
        </section>

        <section class="features-section">
            <div class="container">
                <h2>Key Features of Our Tools</h2>
                <div class="feature-cards">
                    <div class="feature-card">
                        <h3>Effortless Background Removal</h3>
                        <p>Quickly remove backgrounds from your images. Ideal for product photos, profile pictures, and more. Experience clean cutouts with ease.</p>
                    </div>
                    <div class="feature-card">
                        <h3>Optimized Image Compression</h3>
                        <p>Reduce file sizes without compromising quality. Perfect for web optimization, faster loading times, and saving storage space.</p>
                    </div>
                    <div class="feature-card">
                        <h3>Precise Image Resizing</h3>
                        <p>Adjust image dimensions to fit any requirement. Resize photos for social media, print, or web banners while maintaining aspect ratio or custom sizes.</p>
                    </div>
                    <div class="feature-card">
                        <h3>Creative Image Merging</h3>
                        <p>Combine multiple images into one stunning composition. Add custom borders and backgrounds to create unique collages or layouts.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-links">
                <ul>
                    <li><a href="#" target="_blank" rel="noopener noreferrer">Privacy Policy</a></li>
                    <li><a href="#" target="_blank" rel="noopener noreferrer">Terms & Conditions</a></li>
                </ul>
            </div>
            <div class="social-icons">
                <a href="https://facebook.com/yourpage" target="_blank" rel="noopener noreferrer"><i class="fab fa-facebook-f"></i></a>
                <a href="https://instagram.com/yourpage" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram"></i></a>
                <a href="https://linkedin.com/company/yourcompany" target="_blank" rel="noopener noreferrer"><i class="fab fa-linkedin-in"></i></a>
                <a href="https://youtube.com/yourchannel" target="_blank" rel="noopener noreferrer"><i class="fab fa-youtube"></i></a>
            </div>
            <p>Â© 2023 MultiTool App. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const toolButtons = document.querySelectorAll('.tool-button');
            const toolSections = document.querySelectorAll('.tool-section');

            // Function to show/hide tool sections
            function showTool(toolId) {
                toolSections.forEach(section => {
                    section.classList.remove('active');
                });
                const activeTool = document.getElementById(`${toolId}-tool`);
                if (activeTool) {
                    activeTool.classList.add('active');
                    // Reset previews when switching tools
                    const previewArea = activeTool.querySelector('.preview-area img, .preview-area canvas');
                    if (previewArea) {
                        previewArea.style.display = 'none';
                        if (previewArea.tagName === 'IMG') previewArea.src = '';
                        else {
                            const ctx = previewArea.getContext('2d');
                            ctx.clearRect(0, 0, previewArea.width, previewArea.height);
                        }
                    }
                    const downloadBtn = activeTool.querySelector('[id^="download"]');
                    if (downloadBtn) downloadBtn.style.display = 'none';
                }
            }

            // Event listeners for tool selection buttons
            toolButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const toolId = button.dataset.tool;
                    showTool(toolId);
                });
            });

            // --- Generic Image Handling Functions ---
            let currentFile = null;
            let processedDataURL = null; // To store the processed image data for download

            function handleFileUpload(inputElement, previewElement, callback) {
                const file = inputElement.files[0];
                if (!file) return;

                currentFile = file;
                const reader = new FileReader();

                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        if (previewElement.tagName === 'IMG') {
                            previewElement.src = img.src;
                            previewElement.style.display = 'block';
                        }
                        callback(img, file.size); // Pass the image and original size to the specific tool logic
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }

            function downloadImage(dataURL, filename) {
                const a = document.createElement('a');
                a.href = dataURL;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }

            // --- Image Compressor Logic ---
            const compressorInput = document.getElementById('compressorInput');
            const compressionQuality = document.getElementById('compressionQuality');
            const qualityValueSpan = document.getElementById('qualityValue');
            const compressImageBtn = document.getElementById('compressImage');
            const compressorPreview = document.getElementById('compressorPreview');
            const downloadCompressorBtn = document.getElementById('downloadCompressor');
            const compressorOriginalSize = document.getElementById('compressorOriginalSize');
            const compressorNewSize = document.getElementById('compressorNewSize');

            compressionQuality.addEventListener('input', () => {
                qualityValueSpan.textContent = compressionQuality.value;
            });

            compressorInput.addEventListener('change', () => {
                handleFileUpload(compressorInput, compressorPreview, (img, originalSize) => {
                    // Display original size
                    compressorOriginalSize.textContent = `Original Size: ${(originalSize / 1024).toFixed(2)} KB`;
                    compressorOriginalSize.style.display = 'block';
                    compressorNewSize.style.display = 'none'; // Hide new size until processed
                    downloadCompressorBtn.style.display = 'none'; // Hide download button until processed
                });
            });

            compressImageBtn.addEventListener('click', () => {
                if (!currentFile) {
                    alert('Please upload an image first.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        ctx.drawImage(img, 0, 0);

                        const quality = parseFloat(compressionQuality.value) / 100;
                        processedDataURL = canvas.toDataURL('image/jpeg', quality);

                        compressorPreview.src = processedDataURL;
                        compressorPreview.style.display = 'block';

                        // Calculate and display new size
                        fetch(processedDataURL)
                            .then(res => res.blob())
                            .then(blob => {
                                compressorNewSize.textContent = `Compressed Size: ${(blob.size / 1024).toFixed(2)} KB`;
                                compressorNewSize.style.display = 'block';
                            });

                        downloadCompressorBtn.style.display = 'block';
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(currentFile);
            });

            downloadCompressorBtn.addEventListener('click', () => {
                if (processedDataURL) {
                    downloadImage(processedDataURL, `compressed_${currentFile.name.split('.')[0]}.jpg`);
                }
            });

            // --- Image Resizer Logic ---
            const resizerInput = document.getElementById('resizerInput');
            const originalDimensionsSpan = document.getElementById('originalDimensions');
            const newWidthInput = document.getElementById('newWidth');
            const newHeightInput = document.getElementById('newHeight');
            const maintainAspectRatioCheckbox = document.getElementById('maintainAspectRatio');
            const resizeImageBtn = document.getElementById('resizeImage');
            const resizerPreview = document.getElementById('resizerPreview');
            const downloadResizerBtn = document.getElementById('downloadResizer');

            let originalImage = null; // Store the original image object for resizing

            resizerInput.addEventListener('change', () => {
                handleFileUpload(resizerInput, resizerPreview, (img) => {
                    originalImage = img;
                    originalDimensionsSpan.textContent = `${img.width}px x ${img.height}px`;
                    newWidthInput.value = img.width;
                    newHeightInput.value = img.height;
                    downloadResizerBtn.style.display = 'none';
                });
            });

            // Auto-update other dimension when aspect ratio is maintained
            newWidthInput.addEventListener('input', () => {
                if (maintainAspectRatioCheckbox.checked && originalImage) {
                    const newWidth = parseFloat(newWidthInput.value);
                    if (!isNaN(newWidth) && newWidth > 0) {
                        newHeightInput.value = Math.round((newWidth / originalImage.width) * originalImage.height);
                    }
                }
            });

            newHeightInput.addEventListener('input', () => {
                if (maintainAspectRatioCheckbox.checked && originalImage) {
                    const newHeight = parseFloat(newHeightInput.value);
                    if (!isNaN(newHeight) && newHeight > 0) {
                        newWidthInput.value = Math.round((newHeight / originalImage.height) * originalImage.width);
                    }
                }
            });

            resizeImageBtn.addEventListener('click', () => {
                if (!originalImage) {
                    alert('Please upload an image first.');
                    return;
                }

                let newWidth = parseFloat(newWidthInput.value);
                let newHeight = parseFloat(newHeightInput.value);

                if (isNaN(newWidth) || newWidth <= 0 || isNaN(newHeight) || newHeight <= 0) {
                    alert('Please enter valid positive dimensions.');
                    return;
                }

                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = newWidth;
                canvas.height = newHeight;

                // Draw the image scaled to new dimensions
                ctx.drawImage(originalImage, 0, 0, newWidth, newHeight);

                processedDataURL = canvas.toDataURL('image/png'); // Use PNG for quality for resizer
                resizerPreview.src = processedDataURL;
                resizerPreview.style.display = 'block';
                downloadResizerBtn.style.display = 'block';
            });

            downloadResizerBtn.addEventListener('click', () => {
                if (processedDataURL) {
                    downloadImage(processedDataURL, `resized_${currentFile.name.split('.')[0]}.png`);
                }
            });

            // --- Image Merger Logic ---
            const mergerInput1 = document.getElementById('mergerInput1');
            const mergerInput2 = document.getElementById('mergerInput2');
            const mergeBorderColor = document.getElementById('mergeBorderColor');
            const mergeBorderWidth = document.getElementById('mergeBorderWidth');
            const mergeBgColor = document.getElementById('mergeBgColor');
            const mergeImagesBtn = document.getElementById('mergeImages');
            const mergerCanvas = document.getElementById('mergerCanvas');
            const downloadMergerBtn = document.getElementById('downloadMerger');

            let loadedImages = { img1: null, img2: null };

            mergerInput1.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const img = new Image();
                        img.onload = () => { loadedImages.img1 = img; };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });

            mergerInput2.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const img = new Image();
                        img.onload = () => { loadedImages.img2 = img; };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });

            mergeImagesBtn.addEventListener('click', () => {
                if (!loadedImages.img1 || !loadedImages.img2) {
                    alert('Please upload both images to merge.');
                    return;
                }

                const img1 = loadedImages.img1;
                const img2 = loadedImages.img2;
                const borderWidth = parseInt(mergeBorderWidth.value);
                const borderColor = mergeBorderColor.value;
                const bgColor = mergeBgColor.value;

                // For simplicity, let's merge them side-by-side
                const totalWidth = img1.width + img2.width + (borderWidth * 3); // Two images + 3 borders (left, middle, right)
                const maxHeight = Math.max(img1.height, img2.height);
                const totalHeight = maxHeight + (borderWidth * 2); // Top and bottom borders

                mergerCanvas.width = totalWidth;
                mergerCanvas.height = totalHeight;
                const ctx = mergerCanvas.getContext('2d');

                // Draw background
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, totalWidth, totalHeight);

                // Draw border
                ctx.strokeStyle = borderColor;
                ctx.lineWidth = borderWidth;
                ctx.strokeRect(0, 0, totalWidth, totalHeight); // Outer border

                // Draw images
                // Position img1
                ctx.drawImage(img1, borderWidth, (totalHeight - img1.height) / 2);
                // Position img2
                ctx.drawImage(img2, img1.width + (borderWidth * 2), (totalHeight - img2.height) / 2);

                // Draw middle border
                ctx.beginPath();
                ctx.moveTo(img1.width + borderWidth, 0);
                ctx.lineTo(img1.width + borderWidth, totalHeight);
                ctx.stroke();

                processedDataURL = mergerCanvas.toDataURL('image/png');
                mergerCanvas.style.display = 'block';
                downloadMergerBtn.style.display = 'block';
            });

            downloadMergerBtn.addEventListener('click', () => {
                if (processedDataURL) {
                    downloadImage(processedDataURL, `merged_images.png`);
                }
            });

            // --- Background Remover (Conceptual Placeholder) ---
            const bgRemoverInput = document.getElementById('bgRemoverInput');
            const processBgRemoverBtn = document.getElementById('processBgRemover');
            const bgRemoverPreview = document.getElementById('bgRemoverPreview');
            const downloadBgRemoverBtn = document.getElementById('downloadBgRemover');

            bgRemoverInput.addEventListener('change', () => {
                handleFileUpload(bgRemoverInput, bgRemoverPreview, () => {
                    downloadBgRemoverBtn.style.display = 'none';
                });
            });

            processBgRemoverBtn.addEventListener('click', () => {
                if (!currentFile) {
                    alert('Please upload an image first.');
                    return;
                }
                alert('Background removal is a complex feature. For a truly high-quality result, consider integrating a dedicated AI library (like TensorFlow.js with a pre-trained segmentation model) or using a server-side API. This button currently serves as a placeholder.');
                // In a real implementation, you would:
                // 1. Load the image onto a canvas.
                // 2. Apply a sophisticated algorithm or a pre-trained ML model to identify the foreground.
                // 3. Create a new image/canvas with the background removed (e.g., transparent).
                // 4. Update bgRemoverPreview.src and processedDataURL.
                // 5. Show downloadBgRemoverBtn.
                // Example of placeholder output:
                // bgRemoverPreview.src = 'https://via.placeholder.com/400x300/00FF00/000000?text=BG+Removed+Mock'; // Mock output
                // bgRemoverPreview.style.display = 'block';
                // processedDataURL = bgRemoverPreview.src; // For download
                // downloadBgRemoverBtn.style.display = 'block';
            });

            downloadBgRemoverBtn.addEventListener('click', () => {
                if (processedDataURL) {
                    downloadImage(processedDataURL, `bgremoved_${currentFile.name.split('.')[0]}.png`);
                }
            });
        });
    </script>

</body>
</html>
